<!doctype html><html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta><title>使用 JavaScript 实现抽象相等比较（==） - 毛呆&#039;s Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="毛呆&#039;s Blog"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="毛呆&#039;s Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="抽象相等比较（Abstract Equality Comparison）即 &amp;#x3D;&amp;#x3D; 操作符，又被称作宽松相等、非严格相等。 而在抽象相等比较的过程中，为了使 &amp;#x3D;&amp;#x3D; 两侧的数据可以进行比较，会尽可能将它们转换成相同类型，这就是的隐式类型转换。"><meta property="og:type" content="blog"><meta property="og:title" content="使用 JavaScript 实现抽象相等比较（==）"><meta property="og:url" content="https://blog.maodai.site/2020/08/31/%E4%BD%BF%E7%94%A8-JavaScript-%E5%AE%9E%E7%8E%B0%E6%8A%BD%E8%B1%A1%E7%9B%B8%E7%AD%89%E6%AF%94%E8%BE%83%EF%BC%88-%EF%BC%89/"><meta property="og:site_name" content="毛呆&#039;s Blog"><meta property="og:description" content="抽象相等比较（Abstract Equality Comparison）即 &amp;#x3D;&amp;#x3D; 操作符，又被称作宽松相等、非严格相等。 而在抽象相等比较的过程中，为了使 &amp;#x3D;&amp;#x3D; 两侧的数据可以进行比较，会尽可能将它们转换成相同类型，这就是的隐式类型转换。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://blog.maodai.site/img/og_image.png"><meta property="article:published_time" content="2020-08-31T14:04:10.000Z"><meta property="article:modified_time" content="2021-03-21T15:54:31.549Z"><meta property="article:author" content="aweikalee"><meta property="article:tag" content="JavaScript"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.maodai.site/2020/08/31/%E4%BD%BF%E7%94%A8-JavaScript-%E5%AE%9E%E7%8E%B0%E6%8A%BD%E8%B1%A1%E7%9B%B8%E7%AD%89%E6%AF%94%E8%BE%83%EF%BC%88-%EF%BC%89/"},"headline":"使用 JavaScript 实现抽象相等比较（==）","image":["https://blog.maodai.site/img/og_image.png"],"datePublished":"2020-08-31T14:04:10.000Z","dateModified":"2021-03-21T15:54:31.549Z","author":{"@type":"Person","name":"aweikalee"},"description":"抽象相等比较（Abstract Equality Comparison）即 &#x3D;&#x3D; 操作符，又被称作宽松相等、非严格相等。 而在抽象相等比较的过程中，为了使 &#x3D;&#x3D; 两侧的数据可以进行比较，会尽可能将它们转换成相同类型，这就是的隐式类型转换。"}</script><link rel="canonical" href="https://blog.maodai.site/2020/08/31/%E4%BD%BF%E7%94%A8-JavaScript-%E5%AE%9E%E7%8E%B0%E6%8A%BD%E8%B1%A1%E7%9B%B8%E7%AD%89%E6%AF%94%E8%BE%83%EF%BC%88-%EF%BC%89/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-dark.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="//hm.baidu.com/hm.js?603c9db999df88a1cab3437e7ad365e0";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="毛呆&#039;s Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives">分类</a><a class="navbar-item" href="/categories">归档</a><a class="navbar-item" href="/tags">标签</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2020-08-31T14:04:10.000Z" title="8/31/2020, 2:04:10 PM">2020-08-31</time>发表</span><span class="level-item"><a class="link-muted" href="/categories/%E5%89%8D%E7%AB%AF/">前端</a><span> / </span><a class="link-muted" href="/categories/%E5%89%8D%E7%AB%AF/JavaScript/">JavaScript</a></span><span class="level-item">21 分钟读完 (大约3106个字)</span></div></div><h1 class="title is-3 is-size-4-mobile">使用 JavaScript 实现抽象相等比较（==）</h1><div class="content"><html><head></head><body><p><strong>抽象相等比较</strong>（<code>Abstract Equality Comparison</code>）即 <code>==</code> 操作符，又被称作<strong>宽松相等</strong>、<strong>非严格相等</strong>。</p><p>而在<strong>抽象相等比较</strong>的过程中，为了使 <code>==</code> 两侧的数据可以进行比较，会尽可能将它们转换成相同类型，这就是的<strong>隐式类型转换</strong>。</p><span id="more"></span><h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>先来看看 <code>==</code> 那些令人困惑的例子：</p><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log([] == ![])          <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log([] == [])           <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">0</span> == <span class="string">'0'</span>)           <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">0</span> == [])            <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'0'</span> == [])          <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>(<span class="literal">null</span>))      <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>(<span class="literal">undefined</span>)) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="literal">null</span> == <span class="literal">false</span>)      <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="literal">undefined</span> == <span class="literal">false</span>) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="literal">null</span> == <span class="literal">undefined</span>)  <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> a = { <span class="function"><span class="title">toString</span>(<span class="params"></span>)</span> { <span class="keyword">return</span> <span class="string">'0'</span> } }</span><br><span class="line"><span class="keyword">const</span> b = { <span class="function"><span class="title">toString</span>(<span class="params"></span>)</span> { <span class="keyword">return</span> <span class="string">'0'</span> } }</span><br><span class="line"><span class="built_in">console</span>.log(a == <span class="number">0</span>)             <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(b == <span class="number">0</span>)             <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(a == b)             <span class="comment">// false</span></span><br></pre></td></tr></tbody></table></figure><p>让我们根据 <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-abstract-equality-comparison">ECMA-262 Abstract Equality Comparison</a> 实现一个<strong>抽象相等比较</strong>吧，以此来了解比较的过程中发生了什么。</p><h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><h3 id="AbstractEqualityComparison-x-y"><a href="#AbstractEqualityComparison-x-y" class="headerlink" title="AbstractEqualityComparison( x, y )"></a>AbstractEqualityComparison( x, y )</h3><p><strong>抽象相等比较</strong>的主体。</p><h4 id="规范"><a href="#规范" class="headerlink" title="规范"></a>规范</h4><h5 id="原文"><a href="#原文" class="headerlink" title="原文"></a>原文</h5><blockquote><ol><li><p>If <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-ecmascript-data-types-and-values">Type</a>(x) is the same as <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-ecmascript-data-types-and-values">Type</a>(y), then</p><p>​ a. Return the result of performing <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-strict-equality-comparison">Strict Equality Comparison</a> x === y.</p></li><li><p>If x is <strong>null</strong> and y is <strong>undefined</strong>, return <strong>true</strong>.</p></li><li><p>If x is <strong>undefined</strong> and y is <strong>null</strong>, return <strong>true</strong>.</p></li><li><p>If <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-ecmascript-data-types-and-values">Type</a>(x) is Number and <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-ecmascript-data-types-and-values">Type</a>(y) is String, return the result of the comparison x == ! <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-tonumber">ToNumber</a>(y).</p></li><li><p>If <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-ecmascript-data-types-and-values">Type</a>(x) is String and <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-ecmascript-data-types-and-values">Type</a>(y) is Number, return the result of the comparison ! <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-tonumber">ToNumber</a>(x) == y.</p></li><li><p>If <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-ecmascript-data-types-and-values">Type</a>(x) is BigInt and <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-ecmascript-data-types-and-values">Type</a>(y) is String, then</p><p>​ a. Let n be ! <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-stringtobigint">StringToBigInt</a>(y).</p><p>​ b. If n is <strong>NaN</strong>, return <strong>false</strong>.</p><p>​ c. Return the result of the comparison x == n.</p></li><li><p>If <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-ecmascript-data-types-and-values">Type</a>(x) is String and <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-ecmascript-data-types-and-values">Type</a>(y) is BigInt, return the result of the comparison y == x.</p></li><li><p>If <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-ecmascript-data-types-and-values">Type</a>(x) is Boolean, return the result of the comparison ! <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-tonumber">ToNumber</a>(x) == y.</p></li><li><p>If <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-ecmascript-data-types-and-values">Type</a>(y) is Boolean, return the result of the comparison x == ! <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-tonumber">ToNumber</a>(y).</p></li><li><p>If <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-ecmascript-data-types-and-values">Type</a>(x) is either String, Number, BigInt, or Symbol and <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-ecmascript-data-types-and-values">Type</a>(y) is Object, return the result of the comparison x == <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-toprimitive">ToPrimitive</a>(y).</p></li><li><p>If <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-ecmascript-data-types-and-values">Type</a>(x) is Object and <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-ecmascript-data-types-and-values">Type</a>(y) is either String, Number, BigInt, or Symbol, return the result of the comparison <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-toprimitive">ToPrimitive</a>(x) == y.</p></li><li><p>If <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-ecmascript-data-types-and-values">Type</a>(x) is BigInt and <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-ecmascript-data-types-and-values">Type</a>(y) is Number, or if <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-ecmascript-data-types-and-values">Type</a>(x) is Number and <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-ecmascript-data-types-and-values">Type</a>(y) is BigInt, then</p><p>​ a. If x or y are any of <strong>NaN</strong>, <strong>+∞,</strong> or <strong>-∞</strong>, return <strong>false</strong>.</p><p>​ b. If the <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#mathematical-value">mathematical value</a> of x is equal to the <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#mathematical-value">mathematical value</a> of y, return <strong>true</strong>; otherwise return <strong>false</strong>.</p></li><li><p>Return <strong>false</strong>.</p></li></ol><p><em>注： <code>x ==! ToNumber(x)</code> 中的 <code>!</code>的意义我不清楚，但早期的规范里是没有<code>!</code>的，且忽略后逻辑是通顺的，后续都将按忽略处理。</em></p></blockquote><h5 id="译文"><a href="#译文" class="headerlink" title="译文"></a>译文</h5><blockquote><ol><li><p>当 Type(x) 和 Type(y) 相同时，则</p><p>​ a. 返回 x === y。</p></li><li><p>当 x 是 <strong>null</strong> 并且 y 是 <strong>undefined</strong> 时 <strong>true</strong> 。</p></li><li><p>当 x 是 <strong>undefined</strong> 并且 y 是 <strong>null</strong> 时 <strong>true</strong> 。</p></li><li><p>当 Type(x) 是 Number 并且 Type(y) 是 String 时，返回 x == ToNumber(y) 。</p></li><li><p>当 Type(x) 是 String 并且 Type(y) 是 Number 时，返回 ToNumber(x) == y 。</p></li><li><p>当 Type(x) 是 BigInt 并且 Type(y) 是 String 时，则</p><p>​ a. 令 n = StringToBigInt(y) 。</p><p>​ b. 当 n 是 <strong>NaN</strong> 时，返回 <strong>false</strong> 。</p><p>​ c. 返回 x == n 。</p></li><li><p>当 Type(x) 是 String 并且 Type(y) 是 BigInt 时，返回 y == x 。</p></li><li><p>当 Type(x) 是 Boolean 时，返回 ToNumber(x) == y 。</p></li><li><p>当 Type(y) 是 Boolean 时，返回 x == ToNumbery) 。</p></li><li><p>当 Type(x) 是 String, Number, BigInt 或 Symbol 并且 Type(y) 是 Object 时，返回 x == ToPrimitive(y) 。</p></li><li><p>当 Type(x) 是 Object 并且 Type(y) 是 String, Number, BigInt 或 Symbol 时，返回 ToPrimitive(x) == y 。</p></li><li><p>当 Type(x) 是 BigInt 并且 Type(y) 是 Number 时，或者 当 Type(y) 是 Number 并且 Type(y) 是 BigInt 时，则</p><p>​ a. 当 x 或 y 是 <strong>NaN</strong>, <strong>+∞,</strong> or <strong>-∞</strong> 时，返回 <strong>false</strong> 。</p><p>​ b. 当 x 的数值等于 y 的数值时，返回 <strong>true</strong> ，反之 <strong>false</strong>。</p></li><li><p>返回 <strong>false</strong> 。</p></li></ol></blockquote><h4 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h4><p>最费解的想必就是 <code>ToPrimitive</code> 了，我们可以先不管它，先完成主体。</p><p><code>Type</code>, <code>ToNumber</code>, <code>ToPrimitive</code> 等将会在后续再进行说明。</p><p><code>Number</code> 和 <code>BigInt</code> 的数值比较，可以通过 <code>toString(2)</code> 将它们转成二进制字符串，再进行比较。</p><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">AbstractEqualityComparison</span>(<span class="params">x, y</span>) </span>{</span><br><span class="line">  <span class="comment">/* 1 */</span></span><br><span class="line">  <span class="keyword">if</span> (Type(x) === Type(y)) {</span><br><span class="line">    <span class="comment">/* a */</span></span><br><span class="line">    <span class="keyword">return</span> x === y</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 2 */</span></span><br><span class="line">  <span class="keyword">if</span> (x === <span class="literal">null</span> &amp;&amp; y === <span class="literal">undefined</span>) <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 3 */</span></span><br><span class="line">  <span class="keyword">if</span> (x === <span class="literal">undefined</span> &amp;&amp; y === <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 4 */</span></span><br><span class="line">  <span class="keyword">if</span> (Type(x) === <span class="string">'number'</span> &amp;&amp; Type(y) === <span class="string">'string'</span>) {</span><br><span class="line">    <span class="keyword">return</span> AbstractEqualityComparison(x, ToNumber(y))</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 5 */</span></span><br><span class="line">  <span class="keyword">if</span> (Type(x) === <span class="string">'string'</span> &amp;&amp; Type(y) === <span class="string">'number'</span>) {</span><br><span class="line">    <span class="keyword">return</span> AbstractEqualityComparison(ToNumber(x), y)</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 6 */</span></span><br><span class="line">  <span class="keyword">if</span> (Type(x) === <span class="string">'bigint'</span> &amp;&amp; Type(y) === <span class="string">'string'</span>) {</span><br><span class="line">    <span class="comment">/* a */</span></span><br><span class="line">    <span class="keyword">const</span> n = StringToBigInt(y)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* b */</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">Number</span>.isNaN(n)) <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* c */</span></span><br><span class="line">    <span class="keyword">return</span> AbstractEqualityComparison(x, n)</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 7 */</span></span><br><span class="line">  <span class="keyword">if</span> (Type(x) === <span class="string">'string'</span> &amp;&amp; Type(y) === <span class="string">'bigint'</span>) {</span><br><span class="line">    <span class="keyword">return</span> AbstractEqualityComparison(y, x)</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 8 */</span></span><br><span class="line">  <span class="keyword">if</span> (Type(x) === <span class="string">'boolean'</span>) {</span><br><span class="line">    <span class="keyword">return</span> AbstractEqualityComparison(ToNumber(x), y)</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 9 */</span></span><br><span class="line">  <span class="keyword">if</span> (Type(y) === <span class="string">'boolean'</span>) {</span><br><span class="line">    <span class="keyword">return</span> AbstractEqualityComparison(x, ToNumber(y))</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 10 */</span></span><br><span class="line">  <span class="keyword">if</span> (</span><br><span class="line">    [<span class="string">'string'</span>, <span class="string">'number'</span>, <span class="string">'bigint'</span>, <span class="string">'symbol'</span>].includes(Type(x)) &amp;&amp;</span><br><span class="line">    Type(y) === <span class="string">'object'</span></span><br><span class="line">  ) {</span><br><span class="line">    <span class="keyword">return</span> AbstractEqualityComparison(x, ToPrimitive(y))</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 11 */</span></span><br><span class="line">  <span class="keyword">if</span> (</span><br><span class="line">    Type(x) === <span class="string">'object'</span> &amp;&amp;</span><br><span class="line">    [<span class="string">'string'</span>, <span class="string">'number'</span>, <span class="string">'bigint'</span>, <span class="string">'symbol'</span>].includes(Type(y))</span><br><span class="line">  ) {</span><br><span class="line">    <span class="keyword">return</span> AbstractEqualityComparison(ToPrimitive(x), y)</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 12 */</span></span><br><span class="line">  <span class="keyword">if</span> (</span><br><span class="line">    (Type(x) === <span class="string">'bigint'</span> &amp;&amp; Type(y) === <span class="string">'number'</span>) ||</span><br><span class="line">    (Type(x) === <span class="string">'number'</span> &amp;&amp; Type(y) === <span class="string">'bigint'</span>)</span><br><span class="line">  ) {</span><br><span class="line">    <span class="comment">/* a */</span></span><br><span class="line">    <span class="keyword">if</span> ([x, y].some(<span class="function"><span class="params">v</span> =&gt;</span> [<span class="literal">NaN</span>, <span class="literal">Infinity</span>, -<span class="literal">Infinity</span>].includes(v))) {</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* b */</span></span><br><span class="line">    <span class="keyword">return</span> x.toString(<span class="number">2</span>) === y.toString(<span class="number">2</span>)</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 13 */</span></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><em>注：在 <code>12.a</code> 中的 <code>includes</code> 不可使用 <code>indexOf</code> 代替，<code>[NaN].indexOf(NaN)</code> 始终返回 <code>-1</code>。</em></p><h3 id="Type-argument"><a href="#Type-argument" class="headerlink" title="Type( argument )"></a>Type( argument )</h3><p><code>Type</code> 的作用是获取数据的类型。</p><h4 id="规范-1"><a href="#规范-1" class="headerlink" title="规范"></a>规范</h4><h5 id="原文-1"><a href="#原文-1" class="headerlink" title="原文"></a>原文</h5><blockquote><p>An ECMAScript language type corresponds to values that are directly manipulated by an ECMAScript programmer using the ECMAScript language. The ECMAScript language types are Undefined, Null, Boolean, String, Symbol, Number, BigInt, and Object. An ECMAScript language value is a value that is characterized by an ECMAScript language type.</p></blockquote><h4 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h4><p><code>typeof</code> 大致和 <code>Type</code> 一样，</p><p>但 <code>typeof</code> 会将 <code>null</code> 认为是 <code>object</code>，把函数认为 <code>function</code>，</p><p>单独对这两种类型做调整即可。</p><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Type</span>(<span class="params">argument</span>) </span>{</span><br><span class="line">  <span class="keyword">const</span> type = <span class="keyword">typeof</span> argument</span><br><span class="line">  <span class="keyword">if</span> (argument === <span class="literal">null</span>) <span class="keyword">return</span> <span class="string">'null'</span></span><br><span class="line">  <span class="keyword">if</span> (type === <span class="string">'function'</span>) <span class="keyword">return</span> <span class="string">'object'</span></span><br><span class="line">  <span class="keyword">return</span> type</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="ToNumber-argument"><a href="#ToNumber-argument" class="headerlink" title="ToNumber( argument )"></a>ToNumber( argument )</h3><p><code>ToNumber</code> 的作用是将其他类型转换成 <code>Number</code> 类型。</p><h4 id="规范-2"><a href="#规范-2" class="headerlink" title="规范"></a>规范</h4><h5 id="原文-2"><a href="#原文-2" class="headerlink" title="原文"></a>原文</h5><blockquote><p>The abstract operation ToNumber converts argument to a value of type Number according to <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#table-11">Table 11</a>:</p><p><strong>Table 11:</strong> <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-tonumber">ToNumber</a> <strong>Conversions</strong></p><table><thead><tr><th>Argument Type</th><th>Result</th></tr></thead><tbody><tr><td>Undefined</td><td>Return NaN.</td></tr><tr><td>Null</td><td>Return +0.</td></tr><tr><td>Boolean</td><td>If argument is true, return 1. If argument is false, return +0.</td></tr><tr><td>Number</td><td>Return argument (no conversion).</td></tr><tr><td>String</td><td>See grammar and conversion algorithm below.</td></tr><tr><td>Symbol</td><td>Throw a TypeError exception.</td></tr><tr><td>BigInt</td><td>Throw a TypeError exception.</td></tr><tr><td>Object</td><td>Apply the following steps:Let primValue be ? <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-toprimitive">ToPrimitive</a>(argument, hint Number).Return ? <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-tonumber">ToNumber</a>(primValue).</td></tr></tbody></table></blockquote><h5 id="译文-1"><a href="#译文-1" class="headerlink" title="译文"></a>译文</h5><blockquote><p>ToNumber 根据表 11将 argument 转换成 Number 类型的值：</p><p><strong>表 11: ToNumber 转换</strong></p><table><thead><tr><th>Argument 类型</th><th>结果</th></tr></thead><tbody><tr><td>Undefined</td><td>返回 NaN.</td></tr><tr><td>Null</td><td>返回 +0。</td></tr><tr><td>Boolean</td><td>当 argument 是 true 时，返回 1 。当 argument 是 false 时，返回 +0 。</td></tr><tr><td>Number</td><td>返回 argument （不进行转换）。</td></tr><tr><td>String</td><td>见下方语法和转换算法。</td></tr><tr><td>Symbol</td><td>抛出 TypeError 。</td></tr><tr><td>BigInt</td><td>抛出 TypeError 。</td></tr><tr><td>Object</td><td>应用以下步骤：<br>1. 令 primValue = ToPrimitive(argument, hint Number)。<br>2. 返回 ToNumber(primValue) 。</td></tr></tbody></table></blockquote><h4 id="代码-2"><a href="#代码-2" class="headerlink" title="代码"></a>代码</h4><p><code>ToNumber</code>与<code>Number</code> 几乎一致，只不过对于<code>BigInt</code>，<code>ToNumber</code>会直接抛出类型错误。</p><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ToNumber</span>(<span class="params">argument</span>) </span>{</span><br><span class="line">  <span class="keyword">if</span> (Type(argument) === <span class="string">'bigint'</span>) {</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'Cannot convert bigint to number value'</span>)</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Number</span>(argument)</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="StringToBigInt-argument"><a href="#StringToBigInt-argument" class="headerlink" title="StringToBigInt( argument )"></a>StringToBigInt( argument )</h3><p><code>StringToBigInt</code> 的作用是将 <code>String</code> 转成 <code>BigInt</code>。</p><h4 id="代码-3"><a href="#代码-3" class="headerlink" title="代码"></a>代码</h4><p><code>BigInt</code> 中 <code>String</code> 的解析器想必使用的就是 <code>StringToBigInt</code>。</p><p>在 <code>BigInt</code> 中当 <code>StringToBigInt</code> 返回值如果是 <code>NaN</code> 则会直接抛出错误。</p><p>借用 <code>BigInt</code> 实现 <code>StringToBigInt</code> 则就是捕获错误，返回 <code>NaN</code> 。</p><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">StringToBigInt</span>(<span class="params">argument</span>) </span>{</span><br><span class="line">  <span class="keyword">if</span> (Type(argument) !== <span class="string">'string'</span>) {</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'Only accept string'</span>)</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">try</span> {</span><br><span class="line">  	<span class="keyword">return</span> BigInt(argument)</span><br><span class="line">  } <span class="keyword">catch</span> (e) {</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NaN</span></span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="ToPrimitive-input-PreferredType"><a href="#ToPrimitive-input-PreferredType" class="headerlink" title="ToPrimitive( input [, PreferredType ] )"></a>ToPrimitive( input [, PreferredType ] )</h3><p><code>ToPrimitive</code> 的作用是将输入的值转成值类型（除了 <code>Object</code> 以外的基础类型）。</p><h4 id="规范-3"><a href="#规范-3" class="headerlink" title="规范"></a>规范</h4><h5 id="原文-3"><a href="#原文-3" class="headerlink" title="原文"></a>原文</h5><blockquote><ol><li><p><a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#assert">Assert</a>: input is an <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-ecmascript-language-types">ECMAScript language value</a>.</p></li><li><p>If <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-ecmascript-data-types-and-values">Type</a>(input) is Object, then</p><p>​ a. If PreferredType is not present, let hint be <strong>“default”</strong>.</p><p>​ b. Else if PreferredType is hint String, let hint be <strong>“string”</strong>.</p><p>​ c. Else,</p><p>​ i. <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#assert">Assert</a>: PreferredType is hint Number.</p><p>​ ii. Let hint be <strong>“number”</strong>.</p><p>​ d. Let exoticToPrim be ? <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-getmethod">GetMethod</a>(input, @@toPrimitive).</p><p>​ e. If exoticToPrim is not <strong>undefined</strong>, then</p><p>​ i. Let result be ? <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-call">Call</a>(exoticToPrim, input, « hint »).</p><p>​ ii. If <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-ecmascript-data-types-and-values">Type</a>(result) is not Object, return result.</p><p>​ iii. Throw a <strong>TypeError</strong> exception.</p><p>​ f. If hint is <strong>“default”</strong>, set hint to <strong>“number”</strong>.</p><p>​ g. Return ? <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-ordinarytoprimitive">OrdinaryToPrimitive</a>(input, hint).</p></li><li><p>Return input.</p></li></ol></blockquote><h5 id="译文-2"><a href="#译文-2" class="headerlink" title="译文"></a>译文</h5><blockquote><ol><li><p>断言： input 是一个 ECMAScript 语言的值.</p></li><li><p>当 Type(input) 是 Object 时，则</p><p>​ a. 当 PreferredType 不存在时，令 hint = <strong>“default”</strong> 。</p><p>​ b. 否则当 PreferredType 是 String 时，令 hint = <strong>“string”</strong> 。</p><p>​ c. 否则，</p><p>​ i. 断言： PreferredType 是 Number 。</p><p>​ ii. 令 hint = <strong>“number”</strong> 。</p><p>​ d. 令 exoticToPrim = GetMethod(input, @@toPrimitive) 。</p><p>​ e. 当 exoticToPrim 不是 <strong>undefined</strong> 时，则</p><p>​ i. 令 result = Call(exoticToPrim, input, « hint ») 。</p><p>​ ii. 当 Type(result) 不是 Object 时，返回 result 。</p><p>​ iii. 抛出 <strong>TypeError</strong> 。</p><p>​ f. 当 hint 是 <strong>“default”</strong> 时，令 hint = <strong>“number”</strong> 。</p><p>​ g. 返回 OrdinaryToPrimitive(input, hint) 。</p></li><li><p>返回 input 。</p></li></ol></blockquote><h4 id="代码-4"><a href="#代码-4" class="headerlink" title="代码"></a>代码</h4><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ToPrimitive</span>(<span class="params">input, PreferredType</span>) </span>{</span><br><span class="line">  <span class="comment">/* 1 不需要实现 */</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 2 */</span></span><br><span class="line">  <span class="keyword">if</span> (Type(input) === <span class="string">'object'</span>) {</span><br><span class="line">  	<span class="keyword">let</span> hint</span><br><span class="line">    <span class="comment">/* a */</span></span><br><span class="line">    <span class="keyword">if</span> (PreferredType === <span class="literal">undefined</span>) {</span><br><span class="line">      hint = <span class="string">'default'</span></span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* b */</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (PreferredType === <span class="string">'string'</span>) {</span><br><span class="line">      hint = <span class="string">'string'</span></span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* c */</span></span><br><span class="line">    <span class="keyword">else</span> {</span><br><span class="line">      <span class="comment">/* i */</span></span><br><span class="line">      <span class="keyword">if</span> (PreferredType !== <span class="string">'number'</span>) {</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'preferred type must be "string" or "number"'</span>)</span><br><span class="line">      }</span><br><span class="line">      </span><br><span class="line">      <span class="comment">/* ii */</span></span><br><span class="line">      hint = <span class="string">'number'</span></span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* d */</span></span><br><span class="line">    <span class="keyword">const</span> exoticToPrim = GetMethod(input, <span class="built_in">Symbol</span>.toPrimitive)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* e */</span></span><br><span class="line">    <span class="keyword">if</span> (exoticToPrim !== <span class="literal">undefined</span>) {</span><br><span class="line">    	<span class="comment">/* i */</span></span><br><span class="line">      <span class="keyword">const</span> result = exoticToPrim.call(input, hint)</span><br><span class="line">      </span><br><span class="line">    	<span class="comment">/* i */</span></span><br><span class="line">      <span class="keyword">if</span> (Type(result) !== <span class="string">'object'</span>) <span class="keyword">return</span> result</span><br><span class="line">      </span><br><span class="line">    	<span class="comment">/* i */</span></span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'Cannot convert object to primitive value'</span>)</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* f */</span></span><br><span class="line">    <span class="keyword">if</span> (hint === <span class="string">'default'</span>) hint = <span class="string">'number'</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* g */</span></span><br><span class="line">    <span class="keyword">return</span> OrdinaryToPrimitive(input, hint)</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 3 */</span></span><br><span class="line">  <span class="keyword">return</span> input</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="OrdinaryToPrimitive-o-hint"><a href="#OrdinaryToPrimitive-o-hint" class="headerlink" title="OrdinaryToPrimitive( o, hint )"></a>OrdinaryToPrimitive( o, hint )</h3><p><code>OrdinaryToPrimitive</code> 是将 <code>Object</code> 转成值类型。</p><p>参数 <code>hint</code> 控制优先使用 <code>toString</code> 还是 <code>valueOf</code>。</p><h4 id="规范-4"><a href="#规范-4" class="headerlink" title="规范"></a>规范</h4><h5 id="原文-4"><a href="#原文-4" class="headerlink" title="原文"></a>原文</h5><blockquote><ol><li><p><a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#assert">Assert</a>: <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-ecmascript-data-types-and-values">Type</a>(O) is Object.</p></li><li><p><a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#assert">Assert</a>: <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-ecmascript-data-types-and-values">Type</a>(hint) is String and its value is either <strong>“string”</strong> or <strong>“number”</strong>.</p></li><li><p>If hint is <strong>“string”</strong>, then</p><p>​ a. Let methodNames be « <strong>“toString”</strong>, <strong>“valueOf”</strong> ».</p></li><li><p>Else,</p><p>​ a. Let methodNames be « <strong>“valueOf”</strong>, <strong>“toString”</strong> ».</p></li><li><p>For each name in methodNames in <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-list-and-record-specification-type">List</a> order, do</p><p>​ a. Let method be ? <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-get-o-p">Get</a>(O, name).</p><p>​ b. If <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-iscallable">IsCallable</a>(method) is true, then</p><p>​ i. Let result be ? <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-call">Call</a>(method, O).</p><p>​ ii. If <a target="_blank" rel="noopener" href="https://ecma-international.org/ecma-262/#sec-ecmascript-data-types-and-values">Type</a>(result) is not Object, return result.</p></li><li><p>Throw a <strong>TypeError</strong> exception.</p></li></ol></blockquote><h5 id="译文-3"><a href="#译文-3" class="headerlink" title="译文"></a>译文</h5><blockquote><ol><li><p>断言： Type(O) 是 Object 。</p></li><li><p>断言： Type(hint) 是 String 并且 hint 的值 是 <strong>“string”</strong> 或 <strong>“number”</strong> 。</p></li><li><p>当 hint 是 <strong>“string”</strong> 时，则</p><p>​ a. 令 methodNames = « <strong>“toString”</strong>, <strong>“valueOf”</strong> »。</p></li><li><p>否则，</p><p>​ a. 令 methodNames = « <strong>“valueOf”</strong>, <strong>“toString”</strong> »。</p></li><li><p>遍历 methodNames ， 执行</p><p>​ a. 令 method = Get(O, name) 。</p><p>​ b. 当 IsCallable(method) 是 true 时，则</p><p>​ i. 令 result = Call(method, O) 。</p><p>​ ii. 当 Type(result) 不是 Object 时，返回 result 。</p></li><li><p>抛出 <strong>TypeError</strong> 。</p></li></ol></blockquote><h4 id="代码-5"><a href="#代码-5" class="headerlink" title="代码"></a>代码</h4><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">OrdinaryToPrimitive</span>(<span class="params">o, hint</span>) </span>{</span><br><span class="line">  <span class="comment">/* 1 */</span></span><br><span class="line">  <span class="keyword">if</span> (Type(o) !== <span class="string">'object'</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'Only accept Object'</span>)</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 2 */</span></span><br><span class="line">  <span class="keyword">if</span> (Type(hint) !== <span class="string">'string'</span> || ![<span class="string">'string'</span>, <span class="string">'number'</span>].includes(hint)) {</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'Hint value must be "string" or "number"'</span>)</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">let</span> methodNames</span><br><span class="line">  <span class="comment">/* 3 */</span></span><br><span class="line">  <span class="keyword">if</span> (hint === <span class="string">'string'</span>) {</span><br><span class="line">    <span class="comment">/* a */</span></span><br><span class="line">    methodNames = [<span class="string">'toString'</span>, <span class="string">'valueOf'</span>]</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 4 */</span></span><br><span class="line">  <span class="keyword">else</span> {</span><br><span class="line">    <span class="comment">/* a */</span></span><br><span class="line">    methodNames = [<span class="string">'valueOf'</span>, <span class="string">'toString'</span>]</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">	<span class="comment">/* 5 */</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> name <span class="keyword">of</span> methodNames) {</span><br><span class="line">    <span class="comment">/* a */</span></span><br><span class="line">    <span class="keyword">const</span> method = Get(o, name)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* b */</span></span><br><span class="line">    <span class="keyword">if</span> (IsCallable(method)) {</span><br><span class="line">      <span class="comment">/* i */</span></span><br><span class="line">      <span class="keyword">const</span> result = method.call(o)</span><br><span class="line">      </span><br><span class="line">      <span class="comment">/* ii */</span></span><br><span class="line">      <span class="keyword">if</span> (Type(result) !== <span class="string">'object'</span>) <span class="keyword">return</span> result</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 6 */</span></span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'Cannot convert object to primitive value'</span>)</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">GetMethod</span>(<span class="params">v, p</span>) </span>{</span><br><span class="line">  <span class="keyword">if</span> (!isPropertyKey(p)) {</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'Not valid property key'</span>)</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">const</span> func = GetV(v, p)</span><br><span class="line">  <span class="keyword">if</span> (func === <span class="literal">undefined</span> || func === <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">undefined</span></span><br><span class="line">  <span class="keyword">if</span> (!IsCallable(func)) {</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'Not callable'</span>)</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> func</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isPropertyKey</span>(<span class="params">argument</span>) </span>{</span><br><span class="line">  <span class="keyword">if</span> (Type(argument) === <span class="string">'string'</span>) <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  <span class="keyword">if</span> (Type(argument) === <span class="string">'symbol'</span>) <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Get</span>(<span class="params">o, p</span>) </span>{</span><br><span class="line">  <span class="keyword">if</span> (Type(o) !== <span class="string">'object'</span>) {</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'Only accept object'</span>)</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">if</span> (!isPropertyKey(p)) {</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'Not valid property key'</span>)</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> o[p]</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">GetV</span>(<span class="params">v, p</span>) </span>{</span><br><span class="line">  <span class="keyword">if</span> (!isPropertyKey(p)) {</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'Not valid property key'</span>)</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">const</span> o = ToObject(v)</span><br><span class="line">  <span class="keyword">return</span> o[p]</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">IsCallable</span>(<span class="params">argument</span>) </span>{</span><br><span class="line">  <span class="keyword">if</span> (Type(argument) !== <span class="string">'object'</span>) <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">  <span class="keyword">if</span> (!!argument.call) <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ToObject</span>(<span class="params">argument</span>) </span>{</span><br><span class="line">  <span class="keyword">switch</span> (Type(argument)) {</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'boolean'</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Boolean</span>(argument)</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'number'</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Number</span>(argument)</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'string'</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">String</span>(argument)</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'symbol'</span>:</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'bigint'</span>:</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'object'</span>:</span><br><span class="line">      <span class="keyword">return</span> argument</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(</span><br><span class="line">        <span class="string">`Cannot convert <span class="subst">${Type(argument)}</span> to object value`</span></span><br><span class="line">      )</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params">x, y</span>) </span>{</span><br><span class="line">  <span class="keyword">const</span> a = x == y</span><br><span class="line">  <span class="keyword">const</span> b = AbstractEqualityComparison(x, y)</span><br><span class="line">  <span class="keyword">const</span> sign = a === b ? [</span><br><span class="line">    <span class="string">'%cSuccess'</span>,</span><br><span class="line">    <span class="string">'background: green; color: white;'</span></span><br><span class="line">  ] : [</span><br><span class="line">    <span class="string">'%cFailure'</span>,</span><br><span class="line">    <span class="string">'background: red; color: white;'</span></span><br><span class="line">  ]</span><br><span class="line">  <span class="built_in">console</span>.log(...sign, <span class="string">`[<span class="subst">${a}</span>]`</span>, x, y)</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> testData1 = [</span><br><span class="line">  <span class="literal">undefined</span>,</span><br><span class="line">  <span class="literal">null</span>,</span><br><span class="line">  <span class="literal">true</span>,</span><br><span class="line">  <span class="literal">false</span>,</span><br><span class="line">  <span class="string">'123'</span>,</span><br><span class="line">  <span class="built_in">Symbol</span>(<span class="string">'123'</span>),</span><br><span class="line">  <span class="number">123</span>,</span><br><span class="line">  <span class="number">123n</span>,</span><br><span class="line">  [],</span><br><span class="line">  {</span><br><span class="line">    <span class="function"><span class="title">valueOf</span>(<span class="params"></span>)</span> {</span><br><span class="line">      <span class="keyword">return</span> <span class="number">123</span></span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  {</span><br><span class="line">    <span class="function"><span class="title">toString</span>(<span class="params"></span>)</span> {</span><br><span class="line">      <span class="keyword">return</span> <span class="number">123</span></span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">]</span><br><span class="line"><span class="keyword">const</span> testData2 = [</span><br><span class="line">  <span class="literal">undefined</span>,</span><br><span class="line">  <span class="literal">null</span>,</span><br><span class="line">  <span class="literal">true</span>,</span><br><span class="line">  <span class="literal">false</span>,</span><br><span class="line">  <span class="string">'123'</span>,</span><br><span class="line">  <span class="built_in">Symbol</span>(<span class="string">'123'</span>),</span><br><span class="line">  <span class="number">123</span>,</span><br><span class="line">  <span class="number">123n</span>,</span><br><span class="line">  [],</span><br><span class="line">  {</span><br><span class="line">    <span class="function"><span class="title">valueOf</span>(<span class="params"></span>)</span> {</span><br><span class="line">      <span class="keyword">return</span> <span class="number">123</span></span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  {</span><br><span class="line">    <span class="function"><span class="title">toString</span>(<span class="params"></span>)</span> {</span><br><span class="line">      <span class="keyword">return</span> <span class="number">123</span></span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">testData1.forEach(<span class="function">(<span class="params">a</span>) =&gt;</span> {</span><br><span class="line">  testData2.forEach(<span class="function">(<span class="params">b</span>) =&gt;</span> {</span><br><span class="line">    test(a, b)</span><br><span class="line">  })</span><br><span class="line">})</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>在实际开发中，是要尽可能避免使用 <code>==</code> 操作符，有人可能觉得这篇文章没有意义。其实我想传达的是一种学习方法，可以通过相同的方式学习 <code>JavaScript</code> 的其他内容。</p><p>最后，上面实现的 <code>AbstractEqualityComparison</code> 还是有用处的，我在上面代码的基础上写了个 <a target="_blank" rel="noopener" href="https://aweikalee.github.io/abstract-equality-comparison/">抽象相等比较过程展示</a> ，能更清楚地看到比较的过程。不妨输入文章开头的问题，看看比较的过程吧。</p></body></html></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/JavaScript/">JavaScript</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2021/03/08/%E5%B0%86-JSON-stringify-%E6%94%B9%E9%80%A0%E6%88%90-JS-stringify/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">将 JSON.stringify 改造成 JS.stringify</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2020/06/23/%E5%A6%82%E4%BD%95%E5%88%9B%E5%BB%BA%E6%9C%89%E5%BA%8F%E5%AF%B9%E8%B1%A1/"><span class="level-item">如何创建有序对象？</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><!--!--><div class="column column-right is-4-tablet is-4-desktop is-4-widescreen order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#问题"><span class="level-left"><span class="level-item">1</span><span class="level-item">问题</span></span></a></li><li><a class="level is-mobile" href="#实现"><span class="level-left"><span class="level-item">2</span><span class="level-item">实现</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#AbstractEqualityComparison-x-y"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">AbstractEqualityComparison( x, y )</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#规范"><span class="level-left"><span class="level-item">2.1.1</span><span class="level-item">规范</span></span></a></li><li><a class="level is-mobile" href="#代码"><span class="level-left"><span class="level-item">2.1.2</span><span class="level-item">代码</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Type-argument"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">Type( argument )</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#规范-1"><span class="level-left"><span class="level-item">2.2.1</span><span class="level-item">规范</span></span></a></li><li><a class="level is-mobile" href="#代码-1"><span class="level-left"><span class="level-item">2.2.2</span><span class="level-item">代码</span></span></a></li></ul></li><li><a class="level is-mobile" href="#ToNumber-argument"><span class="level-left"><span class="level-item">2.3</span><span class="level-item">ToNumber( argument )</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#规范-2"><span class="level-left"><span class="level-item">2.3.1</span><span class="level-item">规范</span></span></a></li><li><a class="level is-mobile" href="#代码-2"><span class="level-left"><span class="level-item">2.3.2</span><span class="level-item">代码</span></span></a></li></ul></li><li><a class="level is-mobile" href="#StringToBigInt-argument"><span class="level-left"><span class="level-item">2.4</span><span class="level-item">StringToBigInt( argument )</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#代码-3"><span class="level-left"><span class="level-item">2.4.1</span><span class="level-item">代码</span></span></a></li></ul></li><li><a class="level is-mobile" href="#ToPrimitive-input-PreferredType"><span class="level-left"><span class="level-item">2.5</span><span class="level-item">ToPrimitive( input [, PreferredType ] )</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#规范-3"><span class="level-left"><span class="level-item">2.5.1</span><span class="level-item">规范</span></span></a></li><li><a class="level is-mobile" href="#代码-4"><span class="level-left"><span class="level-item">2.5.2</span><span class="level-item">代码</span></span></a></li></ul></li><li><a class="level is-mobile" href="#OrdinaryToPrimitive-o-hint"><span class="level-left"><span class="level-item">2.6</span><span class="level-item">OrdinaryToPrimitive( o, hint )</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#规范-4"><span class="level-left"><span class="level-item">2.6.1</span><span class="level-item">规范</span></span></a></li><li><a class="level is-mobile" href="#代码-5"><span class="level-left"><span class="level-item">2.6.2</span><span class="level-item">代码</span></span></a></li></ul></li><li><a class="level is-mobile" href="#其他"><span class="level-left"><span class="level-item">2.7</span><span class="level-item">其他</span></span></a></li></ul></li><li><a class="level is-mobile" href="#测试"><span class="level-left"><span class="level-item">3</span><span class="level-item">测试</span></span></a></li><li><a class="level is-mobile" href="#结语"><span class="level-left"><span class="level-item">4</span><span class="level-item">结语</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer="defer"></script></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="毛呆&#039;s Blog" height="28"></a><p class="is-size-7"><span>&copy; 2021 aweikalee</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="GitHub" href="https://github.com/aweikalee"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer="defer"></script><script>moment.locale("zh-CN")</script><script>var IcarusThemeSettings={article:{highlight:{clipboard:!0,fold:"unfolded"}}}</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer="defer"></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer="defer"></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer="defer"></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer="defer"></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer="defer"></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer="defer"></script><script src="/js/navbar.js"></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer="defer"></script><script>document.addEventListener("DOMContentLoaded",function(){loadInsight({contentUrl:"/content.json"},{hint:"想要查找什么...",untitled:"(无标题)",posts:"文章",pages:"页面",categories:"分类",tags:"标签"})})</script></body></html>